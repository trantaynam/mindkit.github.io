<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MindKit - Sàng lọc sức khỏe tinh thần</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Quicksand', sans-serif; background-color: #FAF9F6; }
        .option-card:hover { border-color: #A2D2FF; background-color: #F0F7FF; }
        .selected { border-color: #60A5FA !important; background-color: #DBEAFE !important; }
    </style>
</head>
<body class="text-gray-800">

    <div class="bg-red-50 text-red-600 text-center py-2 text-sm font-semibold border-b border-red-100">
        Bạn đang trong tình huống khẩn cấp? Gọi ngay: <a href="tel:18001567" class="underline">1800 1567</a>
    </div>

    <div class="max-w-2xl mx-auto px-4 py-12">
        <div class="mb-8">
            <div class="flex justify-between text-xs mb-2 text-gray-500">
                <span>Tiến trình: <span id="progress-text">0%</span></span>
                <span>Thang đo PHQ-9</span>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-2">
                <div id="progress-bar" class="bg-blue-400 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
            </div>
        </div>

        <div id="quiz-container" class="bg-white rounded-2xl p-8 shadow-sm border border-gray-100">
            <h2 id="question-text" class="text-xl font-semibold mb-6">Đang tải câu hỏi...</h2>
            
            <div class="space-y-3" id="options-container">
                </div>
        </div>

        <div id="result-container" class="hidden bg-white rounded-2xl p-8 shadow-md border border-blue-100 text-center">
            <h2 class="text-2xl font-bold text-blue-600 mb-4">Kết quả của bạn</h2>
            <div id="score-display" class="text-5xl font-bold mb-2">0</div>
            <p id="category-text" class="text-lg font-semibold text-gray-700 mb-6"></p>
            <div id="advice-text" class="p-4 bg-blue-50 rounded-xl text-left text-gray-600 mb-8"></div>
            
            <button onclick="location.reload()" class="text-blue-500 font-medium hover:underline">Thực hiện lại</button>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
const questions = [
    "Ít hứng thú hoặc vui vẻ trong việc thực hiện các công việc.",
    "Cảm thấy xuống sức, trầm cảm hoặc tuyệt vọng.",
    "Khó ngủ, ngủ chập chờn hoặc ngủ quá nhiều.",
    "Cảm thấy mệt mỏi hoặc có ít năng lượng.",
    "Ăn không ngon miệng hoặc ăn quá nhiều."
    // Có thể thêm đủ 9 câu của PHQ-9 tại đây
];

const options = [
    { text: "Không bao giờ", score: 0 },
    { text: "Vài ngày", score: 1 },
    { text: "Hơn một nửa số ngày", score: 2 },
    { text: "Gần như mọi ngày", score: 3 }
];

let currentQuestion = 0;
let totalScore = 0;

function loadQuestion() {
    const qText = document.getElementById('question-text');
    const oContainer = document.getElementById('options-container');
    const progressText = document.getElementById('progress-text');
    const progressBar = document.getElementById('progress-bar');

    qText.innerText = `${currentQuestion + 1}. ${questions[currentQuestion]}`;
    oContainer.innerHTML = '';

    options.forEach(opt => {
        const btn = document.createElement('button');
        btn.className = "option-card w-full text-left p-4 rounded-xl border-2 border-gray-100 transition-all duration-200";
        btn.innerText = opt.text;
        btn.onclick = () => selectOption(opt.score);
        oContainer.appendChild(btn);
    });

    const percent = Math.round((currentQuestion / questions.length) * 100);
    progressText.innerText = `${percent}%`;
    progressBar.style.width = `${percent}%`;
}

function selectOption(score) {
    totalScore += score;
    currentQuestion++;

    if (currentQuestion < questions.length) {
        loadQuestion();
    } else {
        showResult();
    }
}

function showResult() {
    document.getElementById('quiz-container').classList.add('hidden');
    const resultContainer = document.getElementById('result-container');
    resultContainer.classList.remove('hidden');

    let category = "";
    let advice = "";

    if (totalScore <= 4) {
        category = "Bình thường";
        advice = "Bạn đang kiểm soát tốt tâm trạng. Hãy tiếp tục duy trì lối sống lành mạnh.";
    } else if (totalScore <= 9) {
        category = "Trầm cảm nhẹ";
        advice = "Bạn có dấu hiệu căng thẳng nhẹ. Hãy thử dành thời gian nghỉ ngơi, tập thể dục hoặc trò chuyện cùng bạn bè.";
    } else {
        category = "Trầm cảm mức độ trung bình trở lên";
        advice = "Chúng tôi khuyến nghị bạn nên gặp chuyên gia tâm lý tại trường hoặc các cơ sở uy tín để được hỗ trợ chuyên sâu hơn.";
    }

    document.getElementById('score-display').innerText = totalScore;
    document.getElementById('category-text').innerText = category;
    document.getElementById('advice-text').innerText = advice;
}

// Khởi chạy
loadQuestion();
        CREATE TABLE mental_health_logs (
  id uuid DEFAULT gen_random_uuid() PRIMARY KEY,
  test_type text DEFAULT 'PHQ-9',
  score int,
  category text,
  created_at timestamp with time zone DEFAULT now()
);
        // Thêm thư viện Supabase vào thẻ <head> của HTML
// <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

const supabaseUrl = 'YOUR_SUPABASE_URL';
const supabaseKey = 'YOUR_SUPABASE_ANON_KEY';
const supabase = supabasejs.createClient(supabaseUrl, supabaseKey);

async function saveResultToDatabase(score, cat) {
    const { data, error } = await supabase
        .from('mental_health_logs')
        .insert([{ score: score, category: cat }]);
    
    if (error) console.error('Lỗi lưu dữ liệu:', error);
    else console.log('Đã lưu kết quả ẩn danh phục vụ nghiên cứu!');
}

// Gọi hàm này bên trong showResult()
// saveResultToDatabase(totalScore, category);
